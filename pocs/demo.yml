name: poc-yaml-demo
set:
    username: payload.curl.cmd.icontains("curl")
    password: 123456
payloads:
    continues: false
    payloads:
        ping:
            cmd: ping test.com
        curl:
            cmd: curl test.com
# 脚本部分
transport: http # 传输方式
rules: # 规则描述
    r1:
        request:
            method: GET
            path: /
        expression: |
            ("curl").icontains("curl")
    r2:
        request:
          method: POST
          path: ^admin.php?id=100#money
          headers:
              Content-Type: application/xml{{payloads.ping.cmd}}
          body: |
              {{payloads.curl.cmd}}
          follow_redirects: true
        expression: |
            ("curl").icontains("curl")
          
expression: # 规则表达式
    ("curl").icontains("curl")

# 信息部分
detail:
    author: alex(http://github.com/zan8in){{set.password}}
    links: 
        - http://github.com/zan8in/afrog{{set.password}}
    # 指纹信息
    fingerprint:
        infos:
            - id: "长亭指纹库 id{{set.password}}"
              name: "SSH"
              version: "1.0" # {{version}}
              type: "system_bin"
              confidence: 70
        host_info:
            hostname: "test{{set.password}}"
    # 漏洞信息
    vulnerability:
        id: "长亭漏洞库 id"
        match: "证明漏洞存在的信息"
        # 其它字段
        cve: "CVE-2020-1234"
    # 其它未明确定义的字段
    summary: "test"
