id: seeyon-a8-htmlofficeservlet-upload

info:
  name: Seeyon 致远OA A8 htmlofficeservlet 任意文件上传漏洞
  author: zan8in
  severity: critical
  description: |
   远程攻击者在无需登录的情况下可通过向 URL /seeyon/htmlofficeservlet POST 精心构造的数据即可向目标服务器写入任意文件，写入成功后可执行任意系统命令进而控制目标服务器
   title="致远A8-V5协同管理软件 V6.1sp1"
  reference:
    - https://www.cxyzjd.com/article/guangying177/110177339
    - https://github.com/sectestt/CNVD-2019-19299
    - http://wiki.peiqi.tech/wiki/oa/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A8%20htmlofficeservlet%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E.html


rules:
  r0:
    request:
      method: GET
      path: /seeyon/htmlofficeservlet
    expression: response.status == 200 && response.body.bcontains(b'DBSTEP') && response.body.bcontains(b'htmoffice operate')
expression: r0()