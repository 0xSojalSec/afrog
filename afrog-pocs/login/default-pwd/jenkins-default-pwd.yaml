id: jenkins-weak-password

info:
  name: Jenkins Weak Password
  author: zan8in
  severity: high
  tags: jenkins,default-login

manual: true
transport: http
rules:
    r0:
        request:
            handler: allor
            method: POST
            path: /j_spring_security_check
            body: |
              j_username=admin&j_password=admin&from=&Submit=Sign+in
        expression: |
          response.status == 302 && !response.headers["location"].contains("loginError")
    r1:
        request:
            handler: allor
            method: POST
            path: /j_spring_security_check
            body: |
              j_username=jenkins&j_password=password&from=&Submit=Sign+in
        expression: |
          response.status == 302 && !response.headers["location"].contains("loginError")
expression: r0() || r1()
