id: jenkins-default-pwd

info:
  name: Jenkins Default Password
  author: zan8in
  severity: high
  tags: jenkins,default-login

transport: http
rules:
    r0:
        request:
            todo: TODO_FAILURE_NOT_CONTINUE
            method: GET
            path: /login
        expression: |
          response.status == 200 && response.body.bcontains(b'Sign in [Jenkins]')
    r1:
        request:
            todo: TODO_SUCCESS_NOT_CONTINUE
            method: POST
            path: /j_spring_security_check
            body: |
              j_username=admin&j_password=admin&from=&Submit=Sign+in
        expression: |
          response.status == 302 && !response.headers["location"].contains("loginError")
    r2:
        request:
            todo: TODO_SUCCESS_NOT_CONTINUE
            method: POST
            path: /j_spring_security_check
            body: |
              j_username=jenkins&j_password=password&from=&Submit=Sign+in
        expression: |
          response.status == 302 && !response.headers["location"].contains("loginError")
expression: |
    r0() && (r1() || r2())
