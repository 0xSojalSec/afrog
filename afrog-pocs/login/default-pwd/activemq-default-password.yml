id: activemq-default-password

info:
    name: activemq-default-password
    author: pa55w0rd(www.pa55w0rd.online/)
    severity: high
set:
    admin: "base64('admin:admin')"
    user: "base64('user:user')"
manual: true
transport: http
rules:
    r11:
        request:
            todo: TODO_FAILURE_NOT_CONTINUE
            method: GET
            path: /
        expression: response.status == 200 && response.body.bcontains(b"<h2>Welcome to the Apache ActiveMQ!</h2>") && response.body.bcontains(b"<title>Apache ActiveMQ</title>")
    r0:
        request:
            todo: TODO_SUCCESS_NOT_CONTINUE
            method: GET
            path: /admin/
            headers:
                Authorization: Basic {{admin}}
        expression: response.status == 200 && response.body.bcontains(b"Welcome to the Apache ActiveMQ Console of") && response.body.bcontains(b"<h2>Broker</h2>")
    r1:
        request:
            todo: TODO_SUCCESS_NOT_CONTINUE
            method: GET
            path: /admin/
            headers:
                Authorization: Basic {{user}}
        expression: response.status == 200 && response.body.bcontains(b"Welcome to the Apache ActiveMQ Console of") && response.body.bcontains(b"<h2>Broker</h2>")
expression: r11() && (r0() || r1())
