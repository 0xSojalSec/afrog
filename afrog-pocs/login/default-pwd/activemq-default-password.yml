id: activemq-default-password

info:
    name: activemq-default-password
    author: pa55w0rd(www.pa55w0rd.online/)
    severity: high
set:
    admin: "base64('admin:admin')"
    user: "base64('user:user')"
manual: true
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /admin/
            headers:
                Authorization: Basic {{admin}}
        expression: response.status == 200 && response.body.bcontains(b"Welcome to the Apache ActiveMQ Console of") && response.body.bcontains(b"<h2>Broker</h2>")
    r1:
        request:
            cache: true
            method: GET
            path: /admin/
            headers:
                Authorization: Basic {{user}}
        expression: response.status == 200 && response.body.bcontains(b"Welcome to the Apache ActiveMQ Console of") && response.body.bcontains(b"<h2>Broker</h2>")
expression: r0() || r1()
