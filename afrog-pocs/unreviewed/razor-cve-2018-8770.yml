id: razor-cve-2018-8770

info:
    name: razor-cve-2018-8770
    author: we1x4n(https://we1x4n.github.io/)
    severity: high

manual: true
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /tests/generate.php
            follow_redirects: false
        expression: 'response.status == 200 && response.body.bcontains(b"Fatal error: Class ''PHPUnit_Framework_TestCase'' not found in ") && response.body.bcontains(b"/application/third_party/CIUnit/libraries/CIUnitTestCase.php on line")'
expression: r0()
