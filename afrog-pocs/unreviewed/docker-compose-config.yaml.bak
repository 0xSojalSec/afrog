id: docker-compose-config

info:
  name: docker-compose.yml exposure
  author: meme-lord,blckraven,geeknik
  severity: medium
  tags: config,exposure,devops

transport: http
rules:
    r0:
        request:
            method: GET
            path: /docker-compose.yml
            follow_redirects: true
        expression: response.status == 200 && response.body.bcontains(b'services:")') && "^version:".bmatches(response.body)
    r1:
        request:
            method: GET
            path: /docker-compose.prod.yml
            follow_redirects: true
        expression: response.status == 200 && response.body.bcontains(b'services:")') && "^version:".bmatches(response.body)
    r2:
        request:
            method: GET
            path: /docker-compose.production.yml
            follow_redirects: true
        expression: response.status == 200 && response.body.bcontains(b'services:")') && "^version:".bmatches(response.body)
    r3:
        request:
            method: GET
            path: /docker-compose.staging.yml
            follow_redirects: true
        expression: response.status == 200 && response.body.bcontains(b'services:")') && "^version:".bmatches(response.body)

    r4:
        request:
            method: GET
            path: /docker-compose.dev.yml
            follow_redirects: true
        expression: response.status == 200 && response.body.bcontains(b'services:")') && "^version:".bmatches(response.body)
    r5:
        request:
            method: GET
            path: /docker-compose-dev.yml
            follow_redirects: true
        expression: response.status == 200 && response.body.bcontains(b'services:")') && "^version:".bmatches(response.body)
    r6:
        request:
            method: GET
            path: /docker-compose.override.yml
            follow_redirects: true
        expression: response.status == 200 && response.body.bcontains(b'services:")') && "^version:".bmatches(response.body)
expression: r0() || r1() || r2() || r3() || r4() || r5() || r6()